The input data is:

THESHIRE
        RIVENDELL 5 mi via bridge
RIVENDELL
        THESHIRE 5 mi via bridge
        ERABOR 15 mi via bridge
        MORIA 5 mi
ERABOR
        RIVENDELL 15 mi via bridge
        MORIA 17 mi
        EDORAS 22 mi
        MINASTIRITH 20 mi
MORIA
        RIVENDELL 5 mi
        ERABOR 17 mi
        EDORAS 8 mi
EDORAS
        MORIA 8 mi
        ERABOR 22 mi
        MINASTIRITH 10 mi
        OSGILIATH 12 mi
MINASTIRITH
        ERABOR 20 mi
        EDORAS 10 mi
        OSGILIATH 2 mi via bridge
        MINASMORGUL 5 mi
OSGILIATH
        EDORAS 12 mi
        MINASTIRITH 2 mi via bridge
        MINASMORGUL 7 mi
MINASMORGUL
        MINASTIRITH 5 mi
        OSGILIATH 7 mi

The shortest paths from THESHIRE are:

    The shortest path from THESHIRE to EDORAS is 18 mi:
        THESHIRE
        RIVENDELL
        MORIA
        EDORAS
    The shortest path from THESHIRE to ERABOR is 20 mi:
        THESHIRE
        RIVENDELL
        ERABOR
    The shortest path from THESHIRE to MINASMORGUL is 33 mi:
        THESHIRE
        RIVENDELL
        MORIA
        EDORAS
        MINASTIRITH
        MINASMORGUL
    The shortest path from THESHIRE to MINASTIRITH is 28 mi:
        THESHIRE
        RIVENDELL
        MORIA
        EDORAS
        MINASTIRITH
    The shortest path from THESHIRE to MORIA is 10 mi:
        THESHIRE
        RIVENDELL
        MORIA
    The shortest path from THESHIRE to OSGILIATH is 30 mi:
        THESHIRE
        RIVENDELL
        MORIA
        EDORAS
        OSGILIATH
    The shortest path from THESHIRE to RIVENDELL is 5 mi:
        THESHIRE
        RIVENDELL

The road upgrading goal can be achieved at minimal cost by upgrading:
    THESHIRE to RIVENDELL
    RIVENDELL to MORIA
    MORIA to EDORAS
    EDORAS to MINASTIRITH
    MINASTIRITH to OSGILIATH
    MINASTIRITH to MINASMORGUL
    RIVENDELL to ERABOR

Connected components in event of a major storm are:
   If all bridges fail, the following towns would form an isolated group:
        THESHIRE

   If all bridges fail, the following towns would form an isolated group:
        RIVENDELL
        MORIA
        ERABOR
        EDORAS
        MINASTIRITH
        MINASMORGUL
        OSGILIATH

Destruction of any of the following would result in the province becoming
disconnected:
    RIVENDELL


------------------------------------------------------------------

